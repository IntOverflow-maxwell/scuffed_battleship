(function(){"use strict";var t={9948:function(t,e,a){var s=a(9242),i=a(3396),r=a.p+"img/android-chrome-192x192.06bf09ff.png";const o={class:"rightSidebar"},n={key:0},h=(0,i.Uk)(" Room number: "),l=(0,i._)("br",null,null,-1),d=(0,i.Uk)(" In game name: "),u=(0,i.Uk)("Enter the room number and your in game name first ya dingus"),c={class:"main"},p=(0,i.uE)('<div class="header"><img id="badIcon" src="'+r+'"><div class="headerBlock">BattleShip (BS for short)</div><div class="headerBlock"> These links don&#39;t work</div><div class="headerBlock"> lol</div><div class="headerBlock"> No links for you!</div></div>',1);function f(t,e,a,s,r,f){return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",o,["BSChatBox"!==this.state1?((0,i.wg)(),(0,i.iD)("div",n,[h,(0,i._)("input",{ref:"serverCode",onChange:e[0]||(e[0]=(...t)=>f.updateCode&&f.updateCode(...t))},null,544),l,d,(0,i._)("input",{ref:"IGN",onChange:e[1]||(e[1]=(...t)=>f.updateIGN&&f.updateIGN(...t))},null,544)])):(0,i.kq)("",!0),((0,i.wg)(),(0,i.j4)((0,i.LL)(r.state1),null,{default:(0,i.w5)((()=>[u])),_:1}))]),(0,i._)("div",c,[((0,i.wg)(),(0,i.j4)((0,i.LL)(r.state2))),"BSChatBox"!==this.state1?((0,i.wg)(),(0,i.iD)("button",{key:0,onClick:e[2]||(e[2]=t=>{this.state1="BSChatBox",this.state2="BSGame"})},"I'm done with entering the server code and my IGN ")):(0,i.kq)("",!0)]),p],64)}var y=a(7139);const m=t=>((0,i.dD)("data-v-252c3779"),t=t(),(0,i.Cn)(),t),w={class:"BSChatBox"},v=m((()=>(0,i._)("br",null,null,-1))),g=m((()=>(0,i._)("div",null,"Send Message",-1))),b=m((()=>(0,i._)("br",null,null,-1))),C=m((()=>(0,i._)("br",null,null,-1))),B={id:"ChatInput",ref:"ChatInput",placeholder:"Say something..."},S=m((()=>(0,i._)("br",null,null,-1)));function x(t,e,a,s,r,o){return(0,i.wg)(),(0,i.iD)("div",w,[v,g,b,(0,i._)("div",{id:"Chat",ref:"Chat"},(0,y.zw)(this.chatText),513),C,(0,i._)("textarea",B,null,512),S,(0,i._)("button",{id:"SendButton",class:"button",onClick:e[0]||(e[0]=t=>o.send(o.getMsg()))}," Send ")])}a(2801);var k={name:"BSChatBox",created(){this.finished=void 0,this.chatLog=[],this.chatText="",this.lastData="0",this.send(window.inGameName+" has joined the room!"),this.update()},data(){return{finished:this.finished,chatLog:this.chatLog,chatText:this.chatText,lastData:this.lastData}},methods:{getMsg(){let t=window.inGameName+": "+this.$refs.ChatInput.value;return""===this.$refs.ChatInput.value&&(t=""),t},async send(t){if(""===t)return;const e=await fetch("https://demo.httprelay.io/mcast/IntOverflowBSChat"+window.serverCode),a=await e.text();let s=a.split("\n"),i=s.shift();s.length>5&&(s.shift(),i++);let r=i+"\n"+s.join("\n")+"\n"+btoa(t);0===s.length&&(r=i+"\n"+btoa(t));let o={method:"POST",headers:{"Content-Type":"application/json"},body:r};await fetch("https://demo.httprelay.io/mcast/IntOverflowBSChat"+window.serverCode,o),this.$refs.ChatInput.value=""},async update(){let t=fetch("https://demo.httprelay.io/mcast/IntOverflowBSChat"+window.serverCode);const e=new Promise(((t,e)=>setTimeout((()=>e("p2")),2e4)));let a;try{a=await Promise.race([t,e])}catch(o){let t={method:"POST",headers:{"Content-Type":"application/json"},body:this.lastData};return await fetch("https://demo.httprelay.io/mcast/IntOverflowBSChat"+window.serverCode,t),void setTimeout(this.update,10)}let s=await(await a).text();this.lastData=s;let i=s.split("\n"),r=parseInt(i.shift());"undefined"===typeof this.finished&&(this.finished=r);for(let n=0;n<i.length;n++)n+r>=this.finished&&(this.chatLog.push(atob(i[n])),this.finished++);this.chatText=this.chatLog.join("\n"),setTimeout(this.update,1e3)}}},O=a(89);const N=(0,O.Z)(k,[["render",x],["__scopeId","data-v-252c3779"]]);var I=N;const M=(0,i._)("br",null,null,-1);function P(t,e,a,s,r,o){const n=(0,i.up)("BSBoard");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("button",{onClick:e[0]||(e[0]=(...t)=>o.ready&&o.ready(...t))},(0,y.zw)(r.readyMsg),1),M,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(r.boards,(t=>((0,i.wg)(),(0,i.j4)(n,{key:t.id,ref_for:!0,ref:"boards",onClicked:o.handleClick},null,8,["onClicked"])))),128))],64)}const _=t=>((0,i.dD)("data-v-394f7a58"),t=t(),(0,i.Cn)(),t),T=_((()=>(0,i._)("br",null,null,-1)));function G(t,e,a,s,r,o){return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",null,(0,y.zw)(this.inGameName)+"'s board:",1),(0,i._)("canvas",{ref:"Board",height:"500",width:"500",onClick:e[0]||(e[0]=(...t)=>o.handleClick&&o.handleClick(...t)),onMouseenter:e[1]||(e[1]=t=>this.mouseInside=!0),onMouseleave:e[2]||(e[2]=t=>this.mouseInside=!1),onMousemove:e[3]||(e[3]=(...t)=>o.getMousePos&&o.getMousePos(...t))},null,544),T],64)}var j={name:"BSBoard",props:{msg:String},data(){return{board:this.board,inGameName:this.inGameName}},created(){this.inGameName="",this.buttonX=0,this.buttonY=0,this.mouseX=0,this.mouseY=0,this.mouseInside=!1,this.ctx=void 0,this.board=[];for(let t=0;t<10;t++){this.board.push([]);for(let e=0;e<10;e++)this.board[t].push(".")}this.colorMap=new Map,this.colorMap.set(".","rgba(0, 0, 128, 1)").set("#","rgba(170, 170, 170, 1)").set("X","rgba(255, 0, 40, 1)").set("O","rgba(0, 0, 255, 1)")},async mounted(){await this.$nextTick(),this.ctx=this.$refs.Board.getContext("2d"),this.updateCanvas()},methods:{handleClick(){this.$emit("clicked",{x:this.buttonX,y:this.buttonY})},getMousePos(t){let e=this.$refs.Board,a=e.getBoundingClientRect(),s=e.width/a.width,i=e.height/a.height;this.mouseX=(t.clientX-a.left)*s,this.mouseY=(t.clientY-a.top)*i,this.buttonX=Math.floor(this.mouseX/50),this.buttonY=Math.floor(this.mouseY/50)},updateCanvas(){this.ctx.clearRect(0,0,this.$refs.Board.width,this.$refs.Board.height);for(let t=0;t<10;t++)for(let e=0;e<10;e++)this.ctx.beginPath(),this.ctx.rect(50*t,50*e,50,50),this.ctx.fillStyle=this.colorMap.get(this.board[t][e]),this.ctx.fill(),this.ctx.closePath();this.ctx.beginPath();for(let t=0;t<10;t++)for(let e=0;e<10;e++)this.ctx.strokeStyle="rgba(255,255,255,0.2)",this.ctx.strokeRect(50*t,50*e,50,50);this.ctx.closePath(),this.ctx.beginPath(),this.mouseInside&&(this.ctx.rect(50*this.buttonX,50*this.buttonY,50,50),this.ctx.fillStyle="rgba(255,255,255,0.2)",this.ctx.fill()),this.ctx.closePath(),window.requestAnimationFrame(this.updateCanvas)}}};const $=(0,O.Z)(j,[["render",G],["__scopeId","data-v-394f7a58"]]);var Y=$,D={name:"BSGame",components:{BSBoard:Y},async created(){this.readyMsg="Not Ready...",this.player={id:0,state:"NR",inGameName:window.inGameName,hitBoard:[],turn:!1},this.boards=[],this.playerCount=0;for(let t=0;t<10;t++){this.player.hitBoard.push([]);for(let e=0;e<10;e++)this.player.hitBoard[t].push(0)}this.shooting=!1,this.shootX=0,this.shootY=0,this.tileMap=new Map,this.tileMap.set(0,".").set(1,".").set(2,"O").set(3,"X"),await this.initPlayer(),await this.initGameEvent()},data(){return{boards:this.boards,playerCount:this.playerCount,readyMsg:this.readyMsg}},methods:{handleClick(t){if("NR"!==this.player.state)this.player.turn&&(this.shooting=!0,this.shootX=t.x,this.shootY=t.y);else{let e=this.$refs.boards[this.player.id];e.board[t.x][t.y]="#"}},ready(){"Not Ready..."===this.readyMsg?(this.readyMsg="Ready!",this.player.state="R"):(this.readyMsg="Not Ready...",this.player.state="NR"),this.update()},async initPlayer(){let t=fetch("https://demo.httprelay.io/mcast/IntOverflowBS"+window.serverCode);const e=new Promise(((t,e)=>setTimeout((()=>e("p2")),2e4)));let a;try{a=await Promise.race([t,e])}catch(o){let t={method:"POST",headers:{"Content-Type":"application/json"},body:'{"players": []}'};return await fetch("https://demo.httprelay.io/mcast/IntOverflowBS"+window.serverCode,t),void await this.initPlayer()}let s=await(await a).text(),i=JSON.parse(s);this.player.id=i.players.length,i.players.push(this.player);let r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)};await fetch("https://demo.httprelay.io/mcast/IntOverflowBS"+window.serverCode,r)},async update(){const t=await fetch("https://demo.httprelay.io/mcast/IntOverflowBS"+window.serverCode),e=await t.text();let a=JSON.parse(e);this.updatePlayerState(a),this.shooting&&this.handleShot(a),this.updateBoards(a),console.log(JSON.stringify(a));let s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)};await fetch("https://demo.httprelay.io/mcast/IntOverflowBS"+window.serverCode,s),"P"===this.player.state&&setTimeout(this.update,200)},updatePlayerState(t){let e=0;for(let i=0;i<t.players.length;i++)t.players[i].turn&&e++;1!==e&&0===this.player.id&&(t.players[0].turn=!0),this.player.turn=t.players[this.player.id].turn;let a=this.$refs.boards[this.player.id],s=t.players[this.player.id].hitBoard;for(let i=0;i<10;i++)for(let t=0;t<10;t++)1===s[i][t]&&("#"!==a.board[i][t]?(a.board[i][t]="O",s[i][t]=2):(a.board[i][t]="X",s[i][t]=3));t.players[this.player.id]=this.player,t.players[this.player.id].hitBoard=s},handleShot(t){if(this.player.turn){for(let e=0;e<t.players.length;e++)e!==this.player.id&&(t.players[e].hitBoard[this.shootX][this.shootY]=1);t.players[(this.player.id+1)%t.players.length].turn=!0,t.players[this.player.id].turn=!1,this.player.turn=!1,this.shooting=!1}},updateBoards(t){let e;for(let a=0;a<t.players.length;a++)if(e=this.$refs.boards[a],a!==this.player.id)for(let s=0;s<10;s++)for(let i=0;i<10;i++)e.board[s][i]=this.tileMap.get(t.players[a].hitBoard[s][i])},async initGameEvent(){let t=await fetch("https://demo.httprelay.io/mcast/IntOverflowBS"+window.serverCode),e=await t.text();console.log(e);let a=JSON.parse(e),s=!0;for(let i=0;i<a.players.length;i++)"R"!==a.players[i].state&&"P"!==a.players[i].state&&(s=!1),i>=this.playerCount&&(this.playerCount++,this.boards.push(a.players[i]),await this.$nextTick(),this.$refs.boards[i].inGameName=a.players[i].inGameName);if(s)return this.player.state="P",this.readyMsg="Playing...",void await this.update();setTimeout(this.initGameEvent,1e3)}}};const R=(0,O.Z)(D,[["render",P]]);var X=R;window.serverCode="",window.inGameName="";var L={name:"App",components:{BSChatBox:I,BSGame:X},created(){this.state1="div",this.state2="div",this.readyMsg="Not Ready"},data(){return{state1:this.state1,state2:this.state2,readyMsg:this.readyMsg}},methods:{updateCode(){window.serverCode=this.$refs.serverCode.value},updateIGN(){window.inGameName=this.$refs.IGN.value}}};const E=(0,O.Z)(L,[["render",f]]);var J=E;const H=(0,s.ri)(J);H.mount("#app")}},e={};function a(s){var i=e[s];if(void 0!==i)return i.exports;var r=e[s]={exports:{}};return t[s](r,r.exports,a),r.exports}a.m=t,function(){var t=[];a.O=function(e,s,i,r){if(!s){var o=1/0;for(d=0;d<t.length;d++){s=t[d][0],i=t[d][1],r=t[d][2];for(var n=!0,h=0;h<s.length;h++)(!1&r||o>=r)&&Object.keys(a.O).every((function(t){return a.O[t](s[h])}))?s.splice(h--,1):(n=!1,r<o&&(o=r));if(n){t.splice(d--,1);var l=i();void 0!==l&&(e=l)}}return e}r=r||0;for(var d=t.length;d>0&&t[d-1][2]>r;d--)t[d]=t[d-1];t[d]=[s,i,r]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var s in e)a.o(e,s)&&!a.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.p=""}(),function(){var t={143:0};a.O.j=function(e){return 0===t[e]};var e=function(e,s){var i,r,o=s[0],n=s[1],h=s[2],l=0;if(o.some((function(e){return 0!==t[e]}))){for(i in n)a.o(n,i)&&(a.m[i]=n[i]);if(h)var d=h(a)}for(e&&e(s);l<o.length;l++)r=o[l],a.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return a.O(d)},s=self["webpackChunkscuffed_battleship"]=self["webpackChunkscuffed_battleship"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(9948)}));s=a.O(s)})();
//# sourceMappingURL=app.517db87d.js.map